!function(){var moduleFactory=function($){var module=this;$.require().script("mvc/model").done(function(){var exports=function(){var isArray=$.isArray,propCount=function(obj){var count=0;for(var prop in obj)count++;return count},same=function(a,b,deep){var aType=typeof a,aArray=isArray(a);if(-1===deep)return"object"===aType||a===b;if(aType!==typeof b||aArray!==isArray(b))return!1;if(a===b)return!0;if(aArray){if(a.length!==b.length)return!1;for(var i=0;i<a.length;i++)if(!same(a[i],b[i]))return!1;return!0}if("object"===aType||"function"===aType){var count=0;
for(var prop in a){if(!same(a[prop],b[prop],deep===!1?-1:void 0))return!1;count++}return count===propCount(b)}return!1},flatProps=function(a){var obj={};for(var prop in a)("object"!=typeof a[prop]||null===a[prop])&&(obj[prop]=a[prop]);return obj};$.extend($.Model.prototype,{backup:function(){return this._backupStore=this.serialize(),this},isDirty:function(checkAssociations){return this._backupStore?!same(this.serialize(),this._backupStore,!!checkAssociations):!1},restore:function(restoreAssociations){var props=restoreAssociations?this._backupStore:flatProps(this._backupStore);
return this.attrs(props),this}})};exports(),module.resolveWith(exports)})};dispatch("mvc/model.backup").containing(moduleFactory).to("Foundry/2.1 Modules")}();