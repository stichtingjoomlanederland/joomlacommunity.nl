"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],r=!0,n=!1,i=void 0;try{for(var o,_=e[Symbol.iterator]();!(r=(o=_.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{r||null==_.return||_.return()}finally{if(n)throw i}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var acym_helperFilter={setFieldValue:function(e,t){if(e.hasClass("acym_select2_ajax")){var a=e.attr("data-ctrl");a||(a="dynamics");var r=e.attr("data-task");r||(r="trigger");var n=ACYM_AJAX_URL+"&ctrl="+a+"&task="+r+"&id="+encodeURIComponent(t),i=e.attr("data-params"),o=acym_helper.parseJson(i);n+="&"+jQuery.param(o),jQuery.get(n,function(t){if(t=acym_helper.parseJson(t),Array.isArray(t))t.map(function(t,a){var r=new Option(t.text,t.value,!1,!0);e.append(r).trigger("change")});else{var a=new Option(t.text,t.value,!0,!0);e.append(a).trigger("change")}})}else e.is(":checkbox")||void 0!==e.attr("data-switch")?e.is(":checkbox")&&1==t?e.prop("checked",!0):void 0!==e.attr("data-switch")&&e.val()!=t&&e.closest(".medium-3").find(".cell.switch-label").click():e.val(t);void 0!==e.attr("data-rs")&&""!==t&&(-1!==t.indexOf("]")?jQuery('input[data-open="'+e.attr("data-rs")+'"]').val(t):jQuery('input[data-open="'+e.attr("data-rs")+'"]').val(moment.unix(t).format("DD MMM YYYY HH:mm")))},setAutomationReload:function(){jQuery("[acym-automation-reload]").each(function(){jQuery(this).on("change",function(){var e=jQuery(this);setTimeout(function(){var t=e.attr("acym-automation-reload"),a=JSON.parse(t);acym_helper.empty(a.plugin)||(a=[a]),a.forEach(function(e){var t={ctrl:"dynamics",task:"trigger",plugin:e.plugin,trigger:e.trigger};if(e.name&&(t.name=e.name,t.value=jQuery('[name="'+e.name+'"]').val()),e.params)for(var a=0,r=Object.entries(e.params);a<r.length;a++){var n=_slicedToArray(r[a],2),i=n[0],o=n[1];t[i]=o}if(e.paramFields)for(var _=0,c=Object.entries(e.paramFields);_<c.length;_++){var s=_slicedToArray(c[_],2),l=s[0],m=s[1];t[l]=jQuery('[name="'+m+'"]').val()}jQuery.ajax({type:"POST",url:ACYM_AJAX_URL,data:t,success:function(t){var a=jQuery(e.change);a.html(t),["segments","automation"].forEach(function(e){var t=".acym__"+e+"__one__filter.acym__"+e+"__one__filter__classic",r=".acym__"+e+"__inserted__filter input";r+=", .acym__"+e+"__inserted__filter textarea",r+=", .acym__"+e+"__inserted__filter select",a.closest(t).find(r).on("change acym-reloaded",function(){"segments"===e?acym_helperSegment.reloadCounters(a):jQuery.reloadCounters(a)}).trigger("acym-reloaded")}),acym_helperSelect2.setSelect2(),acym_helperSelect2.setAjaxSelect2(),acym_helperTooltip.setTooltip()}})})},100)})})}},acym_helperHeader={setVersionButton:function(){var e=jQuery("#checkVersionButton");e.on("click",function(){var e=jQuery("#checkVersionArea");e.html('<i class="acymicon-circle-o-notch acymicon-spin"></i>');var t=ACYM_AJAX_URL+"&ctrl=update&task=checkForNewVersion";jQuery.get(t,function(t){t=acym_helper.parseJson(t),e.html(t.content),jQuery("#acym__check__version__last__check").html(t.lastcheck)})}),1===e.data("check")&&e.click()}},acym_helperBack={config_get:function(e){var t=ACYM_AJAX_URL+"&ctrl=configuration&task=getAjax&field="+e;return jQuery.ajax({type:"GET",url:t,dataType:"json"})},setDoNotRemindMe:function(){jQuery("#acym__reviews__footer__link").on("click",function(){var e=ACYM_TOGGLE_URL+"&task=setDoNotRemindMe&value="+encodeURIComponent(jQuery(this).attr("title"));jQuery.get(e,function(e){""===(e=acym_helper.parseJson(e)).error?jQuery("#acym__reviews__footer").html(e.message):console.log(e.error)})}),jQuery(".acym__do__not__remindme").on("click",function(){var e=jQuery(this).attr("title");jQuery('[data-news="'+e+'"]').remove();var t=ACYM_TOGGLE_URL+"&task=setDoNotRemindMe&value="+encodeURIComponent(e);jQuery.get(t,function(e){""!==(e=acym_helper.parseJson(e)).error?console.log(e.error):location.reload()})}),jQuery("#acym__multilingual__reminder").on("click",function(){localStorage.setItem("acyconfiguration","languages")})}},acym_helperJoomla={setWidthJoomlaContent:function(){var e=jQuery("#acym__joomla__left-menu");if(e){var t=e.width();jQuery(window).width()<640?(t=0,e.css({display:"none"})):e.css({display:"block"}),jQuery("#acym_content, .acym_no_foundation").css({width:"calc(100% - "+t+"px)","margin-left":t+"px"}),jQuery("#system-message-container").css({"margin-left":t+15+"px"})}},setJoomlaLeftMenu:function(){var e=jQuery("#acym__joomla__left-menu"),t=jQuery("#acym__joomla__left-menu--toggle"),a=jQuery("#acym__joomla__left-menu a span"),r=jQuery("#acym__joomla__left-menu--toggle i");jQuery(".btn-subhead").hide(),"none"!=t.css("display")&&(e.hasClass("collapsed")?(a.hide(),e.css({width:"55px"}),r.removeClass("acymicon-keyboard_arrow_left").addClass("acymicon-keyboard_arrow_right")):(a.show(),e.css({width:"260px"}),r.removeClass("acymicon-keyboard_arrow_right").addClass("acymicon-keyboard_arrow_left")),acym_helperJoomla.setWidthJoomlaContent(),t.off("click").on("click",function(){e.hasClass("collapsed")?(e.removeClass("collapsed"),a.show(),e.css({width:"260px"}),r.removeClass("acymicon-keyboard_arrow_right").addClass("acymicon-keyboard_arrow_left"),acym_helper.setCookie("menuJoomla","",365)):(e.addClass("collapsed"),a.hide(),e.css({width:"55px"}),r.removeClass("acymicon-keyboard_arrow_left").addClass("acymicon-keyboard_arrow_right"),acym_helper.setCookie("menuJoomla","collapsed",365)),acym_helperJoomla.setWidthJoomlaContent()})),jQuery(".btn-navbar").off("click").on("click",function(){e.hide()}),jQuery("#acym__joomla__left-menu--show").off("click").on("click",function(){jQuery(".btn-navbar").hasClass("collapsed")||(".nav-collapse".css("height","0px").removeClass("in"),jQuery(".btn-navbar").removeClass("collapsed")),e.toggle()}),jQuery(window).on("resize",function(){window.innerWidth<950&&!e.hasClass("collapsed")&&t.click(),acym_helperJoomla.setWidthJoomlaContent()})}},acym_helperMailer={setTestCredentialsSendingMethods:function(){jQuery(".acym__configuration__sending__method-test").off("click").on("click",function(){var e=this.getAttribute("sending-method-id");if(void 0===e)return!1;var t=jQuery(this).closest(".acym__sending__methods__credentials__test").find(".acym__configuration__sending__method-icon"),a=jQuery(this).closest(".acym__sending__methods__credentials__test").find(".acym__configuration__sending__method-test__message");t.removeClass("acym__color__red acym__color__green").addClass("acymicon-circle-o-notch acymicon-spin"),a.html("");for(var r={ctrl:"configuration",task:"testCredentialsSendingMethod",sendingMethod:this.getAttribute("sending-method-id")},n=jQuery('[name^="config['.concat(e,'"]')),i=0;i<n.length;i++){var o=n[i];"radio"==o.getAttribute("type")&&o.checked?r[o.getAttribute("name")]=o.value:"radio"!=o.getAttribute("type")&&(r[o.getAttribute("name")]=o.value)}acym_helper.post(ACYM_AJAX_URL,r).then(function(e){var r;r=e.error?"acymicon-times-circle acym__color__red":"acymicon-check-circle acym__color__green",t.removeClass("acymicon-circle-o-notch acymicon-spin"),t.addClass(r),a.html(e.message)})})},setButtonCopyFromPlugin:function(){jQuery(".acym__configuration__copy__mail__settings").off("click").on("click",function(){var e=jQuery(this).closest(".acym__sending__methods__copy__data").find(".acym__configuration__sending__method-icon");e.addClass("acymicon-circle-o-notch acymicon-spin");var t={plugin:jQuery(this).attr("acym-data-plugin"),method:jQuery(this).attr("acym-data-method")},a=ACYM_AJAX_URL+"&ctrl=configuration&task=copySettingsSendingMethod";acym_helper.get(a,t).then(function(e){if(e.error)return acym_helperNotification.addNotification(e.message,"error"),!1;for(var t=0,a=Object.entries(e.data);t<a.length;t++){var r=_slicedToArray(a[t],2),n=r[0],i=r[1],o=jQuery('[name="config['.concat(n,']"]'));0!==o.length&&(void 0!==o.attr("data-switch")&&o.val()!=i?o.closest(".switch").find(".switch-label").trigger("click"):"radio"===o.attr("type")?(o=jQuery('[name="config['.concat(n,']"][value="').concat(i.toLowerCase(),'"]'))).length>0&&o.trigger("click"):o.val(i).trigger("change"))}}).always(function(t){e.removeClass("acymicon-circle-o-notch acymicon-spin")})})},setSynchroExistingUsers:function(){jQuery(".acym__configuration__sending__synch__users").off("click").on("click",function(){var e=this.getAttribute("sending-method-id");if(void 0===e)return!1;var t=jQuery(this).closest(".acym__sending__methods__synch").find(".acym__configuration__sending__method-icon"),a=jQuery(this).closest(".acym__sending__methods__synch").find(".acym__configuration__sending__method-synch__message");t.removeClass("acym__color__red acym__color__green").addClass("acymicon-circle-o-notch acymicon-spin"),a.html("");var r={ctrl:"configuration",task:"synchonizeExistingUsers",sendingMethod:e};acym_helper.post(ACYM_AJAX_URL,r).then(function(e){var r;r=e.error?"acymicon-times-circle acym__color__red":"acymicon-check-circle acym__color__green",t.removeClass("acymicon-circle-o-notch acymicon-spin"),t.addClass(r),a.html(e.message)})})}},acym_helperNotification={setNotificationCenter:function(){acym_helperNotification.removeNotifications();var e=jQuery(".acym__header__notification");e.find("i").hasClass("acymicon-check-circle")&&setTimeout(function(){e.find("> i").attr("class","acymicon-bell-o"),e.find(".acym__tooltip__text").remove(),e.removeAttr("data-acym-tooltip").removeAttr("data-acym-tooltip-position").removeClass("acym__header__notification__button__success acym__header__notification__pulse")},8e3),e.off("click").on("click",function(){var t=jQuery(this),a=jQuery(".acym__header__notification__center"),r=t.offset(),n=r.left-a.width()+t.width()+"px",i=r.top+t.height()+10+"px";a.css({top:i,left:n}).addClass("acym__header__notification__center__visible");var o=ACYM_AJAX_URL+"&ctrl=configuration&task=markNotificationRead";jQuery.get(o,function(e){void 0===(e=acym_helper.parseJson(e)).error?jQuery(".acym__header__notification").removeClass("acym__header__notification__pulse acym__header__notification__button__success acym__header__notification__button__info acym__header__notification__button__warning acym__header__notification__button__error").find("> i").attr("class","acymicon-bell-o"):console.log(e.error)}),e.off("click").on("click",function(e){if(jQuery(e.target).hasClass("acym__header__notification__center__visible")||jQuery(e.target).closest(".acym__header__notification__center__visible").length>0)return!0;acym_helperNotification.removeNotificationsCenter()}),setTimeout(function(){jQuery(window).off("click").on("click",function(e){if(jQuery(e.target).hasClass("acym__header__notification__center__visible")||jQuery(e.target).closest(".acym__header__notification__center__visible").length>0)return!0;acym_helperNotification.removeNotificationsCenter()})},100)}),jQuery(".acym__message__close").off("click").on("click",function(){var e=jQuery(this),t=e.attr("data-id");if(void 0!==t&&0!=t){var a=ACYM_AJAX_URL+"&ctrl=configuration&task=markNotificationRead&id="+t;jQuery.get(a,function(t){void 0===(t=acym_helper.parseJson(t)).error?e.closest(".acym__message").remove():console.log(t.error)})}else e.closest(".acym__message").remove()})},removeNotifications:function(){jQuery(".acym__header__notification__one__delete, .acym__header__notification__toolbox__remove").off("click").on("click",function(){var e=jQuery(this).hasClass("acym__header__notification__toolbox__remove")?"all":jQuery(this).attr("data-id"),t=ACYM_AJAX_URL+"&ctrl=configuration&task=removeNotification&id="+e;jQuery.get(t,function(e){void 0===(e=acym_helper.parseJson(e)).error?(jQuery(".acym__header__notification__center").html(e.data),jQuery(".acym__header__notification").find("> i").attr("class","acymicon-bell-o"),acym_helperNotification.removeNotifications()):console.log(e.error)})})},removeNotificationsCenter:function(){jQuery(".acym__header__notification__center").removeClass("acym__header__notification__center__visible"),jQuery(window).off("click"),acym_helperNotification.setNotificationCenter()},addNotification:function(e,t,a){void 0===a&&(a=!1),a&&jQuery(".acym__message").remove(),void 0!==t&&-1!=jQuery.inArray(t,["success","warning","error"])||(t="info");var r=acym_helperNotification.addHeaderNotification(e,t);jQuery("#acym_header").after(r);var n=ACYM_AJAX_URL+"&ctrl=configuration&task=addNotification&message="+e+"&level="+t;jQuery.get(n,function(e){void 0===(e=acym_helper.parseJson(e)).error?(jQuery(".acym__header__notification").replaceWith(e.data),acym_helperNotification.setNotificationCenter()):console.log(e.error)})},addHeaderNotification:function(e,t){return'<div class="acym__message grid-x acym__message__'+t+'"><div class="cell auto"><p>'+e+'</p></div><i data-id="0" class="cell shrink acym__message__close acymicon-remove"></i></div>'}},acym_helperSegment={filterRebuilt:!0,blocksRebuilt:!0,ajaxCalls:{},globalAjaxCall:"",reloadCounters:function(e){if(acym_helperSegment.filterRebuilt){var t=jQuery(e).closest(".acym__segments__inserted__filter").attr("data-and"),a=jQuery(e).closest("[data-filter-number]").attr("data-filter-number"),r=ACYM_AJAX_URL+"&page=acymailing_segments&ctrl=segments&task=countResults&and="+t+"&or="+a;void 0!==this.ajaxCalls[t]&&this.ajaxCalls[t].abort(),jQuery("#results_"+t).find(".acym__segments__edit__filter-results").html('<i class="acymicon-circle-o-notch acymicon-spin"></i>');var n=jQuery(e).closest("#acym_form").serialize()+"&page=acymailing_segments&ctrl=segments&task=countResults&and="+t+"&or="+a;this.ajaxCalls[t]=jQuery.post(r,n).done(function(e){e=acym_helper.parseJson(e),jQuery("#results_"+t).find(".acym__segments__edit__filter-results").html(e.message)}).fail(function(){jQuery("#results_"+t).find(".acym__segments__edit__filter-results").html(ACYM_JS_TXT.ACYM_ERROR)}),this.reloadGlobalCounter()}},reloadGlobalCounter:function(){if(acym_helperSegment.blocksRebuilt){var e="";if(jQuery("#acym__campaigns__segment").length>0)e=jQuery("#acym__campaigns__segment__edit-user-count");else{var t=jQuery(".acym__segments__edit__filters__no-users");if(e=jQuery(".acym__segments__edit__filters__total"),0===jQuery("[name^=acym_action]").length)return t.show(),void e.hide();t.hide(),e.show()}""!==this.globalAjaxCall&&(this.globalAjaxCall.abort(),this.globalAjaxCall="");var a=jQuery(".acym__segments__group__filter"),r=ACYM_AJAX_URL+"&page=acymailing_segments&ctrl=segments&task=countResultsTotal";e.html('<i class="acymicon-circle-o-notch acymicon-spin"></i>'),this.globalAjaxCall=jQuery.post(r,a.closest("#acym_form").serialize()+"&page=acymailing_segments&ctrl=segments&task=countResultsTotal").done(function(t){t=acym_helper.parseJson(t),e.html(t.count)}).fail(function(){e.html(ACYM_JS_TXT.ACYM_ERROR)})}},refreshFilterProcess:function(){this.setSelectFilters("classic"),this.setAddFilter(),this.setDeleteFilter(),acym_helperDatePicker.setDatePickerGlobal(),acym_helperDatePicker.setRSDateChoice(),acym_helperSelect2.setAjaxSelect2(),this.setAddFilterOr()},setSelectFilters:function(e){var t=jQuery("#acym__campaigns__segment").length>0,a=jQuery("#acym__segments__edit__info__options");if(a.length){var r=JSON.parse(a.val());jQuery(".acym__segments__select__"+e+"__filter").off("change").on("change",function(){t&&jQuery('[name="segment_selected"]').val("");var e=jQuery("#acym__segments__filters__count__and"),a="";0!==parseInt(e.val())&&(a='<span class="cell acym_vcenter acym__segments__delete__one__filter"><i class="acymicon-delete"></i>'.concat(ACYM_JS_TXT.ACYM_DELETE_THIS_FILTER,"</span>")),e.val(parseInt(e.val())+1);var n=acym_helperSegment.getSeeUserModalButton(jQuery(this),e.val());jQuery(this).parent().parent().find(".acym__segments__inserted__filter").remove();var i=r[jQuery(this).val()].replace(/__numor__/g,jQuery(this).closest(".acym__segments__group__filter").attr("data-filter-number"));i=i.replace(/__numand__/g,e.val());var o=t?"medium-9":"medium-6";jQuery(this).parent().after('<div data-and="'+e.val()+'" class="cell grid-x grid-margin-x grid-margin-y acym__segments__inserted__filter margin-top-1 margin-left-2 acym_vcenter"><div class="cell grid-x '+o+' grid-margin-x grid-margin-y">'+i+'</div><span class="countresults margin-bottom-1 cell auto grid-x" id="results_'+e.val()+'"><span class="acym__segments__edit__filter-results cell"></span>'+a+n+"</span></div>"),acym_helperSelect2.setSelect2(),acym_helperDatePicker.setDatePickerGlobal(),acym_helperTooltip.setTooltip(),acym_helperFilter.setAutomationReload(),jQuery(document).foundation(),jQuery(document).trigger("acym__modal__users__summary__ready"),jQuery(".switch-label").off("click").on("click",function(){var e=jQuery('input[data-switch="'+jQuery(this).attr("for")+'"]');e.attr("value",1-e.attr("value"))});var _=jQuery(this).closest(".acym__segments__one__filter").find(".acym__automation__filters__operator__dropdown"),c=jQuery(this).closest(".acym__segments__one__filter").find(".acym__automation__filters__fields__dropdown");_.on("change",function(){c.trigger("change")}),c.on("change",function(){var e=jQuery(this).closest(".acym__segments__inserted__filter"),t=e.find('[data-filter-field="'+jQuery(this).val()+'"]'),a=e.find(".acym__automation__filters__fields__select"),r=e.find(".acym__automation__filter__regular-field");t.length>0&&("="===_.val()||"!="===_.val())?(r.attr("name",r.attr("name").replace("acym_action","")).hide(),a.each(function(e){jQuery(this).attr("name",jQuery(this).attr("name").replace("acym_action","")),jQuery(this).closest(".acym__automation__one-field").hide()}),-1===t.attr("name").indexOf("acym_action")&&t.attr("name","acym_action"+t.attr("name")),t.closest(".acym__automation__one-field").show()):(-1===r.attr("name").indexOf("acym_action")&&r.attr("name","acym_action"+r.attr("name")),a.length>0&&a.each(function(){jQuery(this).attr("name",jQuery(this).attr("name").replace("acym_action","")),jQuery(this).closest(".acym__automation__one-field").hide()}),r.show())}).trigger("change"),jQuery(this).closest(".acym__segments__one__filter.acym__segments__one__filter__classic").find(".acym__segments__inserted__filter input, .acym__segments__inserted__filter select").on("change",function(){acym_helperSegment.reloadCounters(this)}),0==jQuery(this).val()?acym_helperSegment.reloadGlobalCounter(jQuery(this).closest(".acym__segments__group__filter")):acym_helperSegment.reloadCounters(jQuery(this).closest(".acym__segments__one__filter.acym__segments__one__filter__classic").find(".acym__segments__inserted__filter input, .acym__segments__inserted__filter select, .acym__segments__inserted__filter textarea")),jQuery(document).foundation(),jQuery(".reveal-overlay").appendTo("#acym_form"),acym_helperSegment.refreshFilterProcess()})}},setAddFilter:function(){jQuery(".acym__segments__add-filter").off("click").on("click",function(){if(0===jQuery(this).closest(".acym__segments__group__filter").find(".acym__segments__one__filter").length){var e=jQuery("#acym__segments__and__example").clone().removeAttr("id");e.find(".acym__automation__and").remove(),jQuery(this).parent().before(e.show())}else jQuery(this).parent().before(jQuery("#acym__segments__and__example").clone().removeAttr("id").show());var t=jQuery(this).parent().prev();t.addClass("acym__segments__one__filter__"+jQuery(this).attr("data-filter-type")),t.find(".acym__segments__and__example__"+jQuery(this).attr("data-filter-type")+"__select").show().find("select").addClass("acym__select").select2({theme:"foundation",width:"100%"}),acym_helperSegment.refreshFilterProcess()})},setDeleteFilter:function(){jQuery(".acym__segments__delete__one__filter").off("click").on("click",function(){jQuery(this).closest(".acym__segments__one__filter").remove(),acym_helperSegment.reloadGlobalCounter()}),jQuery(".acym__segments__delete__one__or").off("click").on("click",function(){jQuery(this).closest(".acym__segments__or__container").remove(),acym_helperSegment.reloadGlobalCounter()})},rebuildFilters:function(){var e=jQuery("#acym__segments__filters");if(""!==e.val()){var t=JSON.parse(e.val()),a=0,r=parseInt(Object.keys(t).slice(-1)[0]);acym_helperSegment.blocksRebuilt=!1,jQuery.each(t,function(e,t){0!==a&&jQuery(".acym__automation__filters__or").click();var n=0,i=Object.keys(t).slice(-1)[0];jQuery.each(t,function(t,o){0!==n&&jQuery('.acym__segments__group__filter[data-filter-number="'+a+'"]').find(".acym__segments__add-filter[data-filter-type]").click(),acym_helperSegment.filterRebuilt=!1,jQuery.each(o,function(n,o){var _=jQuery('.acym__segments__group__filter[data-filter-number="'+a+'"]').find(".acym__segments__select__classic__filter").last();_.val(n),_.trigger("change");var c=Object.keys(o);jQuery.each(c,function(_){var s=c[_],l=o[c[_]],m=jQuery('[name="acym_action[filters]['+a+"]["+jQuery("#acym__segments__filters__count__and").val()+"]["+n+"]["+s+']"]');acym_helperFilter.setFieldValue(m,l),_===c.length-1&&(acym_helperSegment.filterRebuilt=!0,i===t&&r===parseInt(e)&&(acym_helperSegment.blocksRebuilt=!0)),m.trigger("change")})}),n++}),a++}),this.refreshFilterProcess()}},setAddFilterOr:function(){jQuery(".acym__automation__filters__or").off("click").on("click",function(){var e=jQuery("#acym__automation__filters__count__or");e.val(parseInt(e.val())+1),jQuery(this).before(jQuery("#acym__automation__or__example").html());var t=jQuery(this).prev();t.find(".acym__segments__group__filter").attr("data-filter-number",e.val()),acym_helperSegment.refreshFilterProcess(),t.find("button[data-filter-type]").click(),"classic"===jQuery(this).attr("data-filter-type")&&acym_helperSegment.reloadGlobalCounter(t)})},getSeeUserModalButton:function(e,t){var a="acym__segments__see-users__".concat(t),r=jQuery("#acym__segment__see-users__example").clone(),n=jQuery("#acym__segments__see-users").closest(".reveal-overlay").clone();r.find('[data-open="acym__segments__see-users"]').attr("data-open",a),n.find("#acym__segments__see-users").attr("id",a);var i={ctrl:"segments",task:"usersSummary",and:t,or:e.closest("[data-filter-number]").attr("data-filter-number")};n.find("[acym-data-query]").attr("acym-data-query",JSON.stringify(i));var o=r.html()+n[0].outerHTML;return'<span class="cell shrink acym__segments__see-users">'.concat(o,"</span>")}},acym_helperSelect2={initJsSelect2:function(){this.setSelect2(),this.setAjaxSelect2(),this.setSelect2Email(),this.setSelect2ChooseTagsGlobal()},setSelect2:function(){jQuery(".acym__select:not([acym-data-infinite])").select2({theme:"foundation",width:"100%"}),jQuery(".acym__select[acym-data-infinite]").select2({theme:"foundation",width:"100%",minimumResultsForSearch:1/0}),jQuery(".intext_select").select2({theme:"foundation",minimumResultsForSearch:1/0})},setAjaxSelect2:function(){jQuery(".acym_select2_ajax").each(function(){var e=jQuery(this).attr("data-placeholder");e||(e="- - -");var t=jQuery(this).attr("data-ctrl");t||(t="dynamics");var a=jQuery(this).attr("data-task");a||(a="trigger");var r=jQuery(this).attr("acym-data-default"),n={ctrl:t,task:a},i=jQuery(this).attr("data-params");if(i){var o=JSON.parse(i);Object.assign(n,o)}var _=jQuery(this).attr("data-min");_||(_=3),jQuery(this).select2({theme:"foundation",ajax:{url:ACYM_AJAX_URL,dataType:"json",delay:250,data:function(e){return n.search=e.term,n},processResults:function(e){var t=[];return void 0===r||""!==n.search&&void 0!==n.search||t.push({id:0,text:r}),e&&jQuery.each(e,function(e,a){t.push({id:a[0],text:a[1]})}),{results:t}},cache:!0},minimumInputLength:_,width:"100%",allowClear:!0,placeholder:e});var c=jQuery(this).attr("data-selected");if(void 0!==c){var s=ACYM_AJAX_URL+"&ctrl="+t+"&task="+a+"&id="+encodeURIComponent(c),l=jQuery(this);void 0!==n.plugin&&void 0!==n.trigger&&(s+="&plugin=".concat(n.plugin,"&trigger=").concat(n.trigger)),jQuery.get(s,function(e){if(e=acym_helper.parseJson(e),Array.isArray(e))e.map(function(e,t){var a=new Option(e.text,e.value,!1,!0);l.append(a)});else{var t=new Option(e.text,e.value,!1,!1);l.append(t)}})}})},setSelect2Email:function(){var e=jQuery(".acym__multiselect__email"),t={ctrl:"campaigns",task:"searchTestReceivers"};e.select2({width:"100%",placeholder:e.attr("placeholder"),tags:!0,theme:"foundation",tokenSeparators:[" ",",",";"],createTag:function(e){var t=jQuery.trim(e.term);return acym_helper.emailValid(t)?{id:t,text:t}:null},ajax:{url:ACYM_AJAX_URL,dataType:"json",delay:250,data:function(e){return t.search=e.term,t},processResults:function(t){var a=[];return t&&jQuery.each(t,function(t,r){var n=r[0];e.length>1&&(n=r[1]),a.push({id:n,text:r[1]})}),{results:a}}},minimumInputLength:3})},setSelect2ChooseTagsGlobal:function(){var e=jQuery("#acym__tags__field"),t=e.attr("placeholder");e.select2({width:"100%",placeholder:t,tags:!0,theme:"foundation",tokenSeparators:[" "],createTag:function(e){var t=jQuery.trim(e.term);return""===t?null:{id:"acy_new_tag_"+t,text:t,newTag:!0}}})}},acym_helperStats={setLineChartOpenTimeWeek:function(){if(null!==document.getElementById("acym__stats__global__open-time__data")){var e=document.getElementById("acym__stats__global__open-time__data").value;if(void 0!==e){e=acym_helper.parseJson(e);var t,a,r={sunday:[],other:[]},n={sunday:[],other:[]},i={0:ACYM_JS_TXT.ACYM_SUNDAY,1:ACYM_JS_TXT.ACYM_MONDAY,2:ACYM_JS_TXT.ACYM_TUESDAY,3:ACYM_JS_TXT.ACYM_WEDNESDAY,4:ACYM_JS_TXT.ACYM_THURSDAY,5:ACYM_JS_TXT.ACYM_FRIDAY,6:ACYM_JS_TXT.ACYM_SATURDAY},o={1:"3h",2:"6h",3:"9h",4:"12h",5:"15h",6:"18h",7:"21h"};e.map(function(e,t){var a=0===t?"sunday":"other";e.map(function(e,_){0===_?r[a].push(i[t]):r[a].push(o[_]),n[a].push(e)})}),t=r.other.concat(r.sunday),a=n.other.concat(n.sunday);new Chart(document.getElementById("chartjs-0"),{type:"line",data:{labels:t,datasets:[{label:ACYM_JS_TXT.ACYM_OPEN_PERCENTAGE,data:a,fill:!1,borderColor:"rgb(0, 165, 255)",lineTension:.1}]},options:{responsive:!0,legend:{display:!1},maintainAspectRatio:!1,tooltips:{backgroundColor:"#fff",borderWidth:2,borderColor:"#303e46",titleFontSize:16,titleFontColor:"#303e46",bodyFontColor:"#303e46",bodyFontSize:14,displayColors:!1},scales:{yAxes:[{gridLines:{display:!1},ticks:{display:!0,fontColor:"#0a0a0a"}}],xAxes:[{gridLines:{display:!1},ticks:{display:!0,fontSize:14,fontColor:"#0a0a0a"}}]}}})}}}};