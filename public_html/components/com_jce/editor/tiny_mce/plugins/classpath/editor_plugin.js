/* jce - 2.8.0 | 2019-11-20 | https://www.joomlacontenteditor.net | Copyright (C) 2006 - 2019 Ryan Demmer. All rights reserved | GNU/GPL Version 2 or later - http://www.gnu.org/licenses/gpl-2.0.html */
!function(){var each=tinymce.each,DOM=tinymce.DOM,PreviewCss=tinymce.util.PreviewCss;tinymce.create("tinymce.plugins.ClassPathPlugin",{convertSelectorToFormat:function(selectorText){var format,ed=this.editor;if(selectorText){var selector=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(selectorText);if(selector){var elementName=selector[1];if("body"!==elementName){var classes=selector[2].substr(1).split(".").join(" "),inlineSelectorElements=tinymce.makeMap("a,img");return elementName?(format={title:selectorText},ed.schema.getTextBlockElements()[elementName]?format.block=elementName:ed.schema.getBlockElements()[elementName]||inlineSelectorElements[elementName.toLowerCase()]?format.selector=elementName:format.inline=elementName):selector[2]&&(format={inline:"span",selector:"*",title:selectorText.substr(1)}),ed.settings.importcss_merge_classes!==!1?format.classes=classes:format.attributes={class:classes},format}}}},init:function(ed,url){var path,tags,combobox,self=this;this.editor=ed,ed.onPostRender.add(function(){var container=ed.getContentAreaContainer();path=DOM.create("div",{class:"mceClassPath"}),tags=DOM.create("div",{class:"mceClassPathTags"}),combobox=DOM.create("div",{class:"mceClassPathCombobox"});var ctrl=ed.controlManager.createListBox("classpath",{combobox:!0,max_height:384,onselect:function(name){var matches,removedFormat,formatNames=[];return each(ctrl.items,function(item){formatNames.push(item.value)}),ed.focus(),ed.undoManager.add(),matches=ed.formatter.matchAll(formatNames),tinymce.each(matches,function(match){name&&match!==name||(match&&ed.formatter.remove(match),removedFormat=!0)}),removedFormat||(ed.formatter.get(name)?ed.formatter.apply(name):ed.formatter.apply("classname",{value:name})),ed.undoManager.add(),ed.nodeChanged(),!1}}),counter=0;ctrl.onBeforeRenderMenu.add(function(){ed.settings.importcss_classes||ed.onImportCSS.dispatch(),Array.isArray(ed.settings.importcss_classes)&&(ctrl.hasClasses||(each(ed.settings.importcss_classes,function(s,idx){var name="style_"+(counter+idx),fmt=self.convertSelectorToFormat(s);fmt&&(ed.formatter.register(name,fmt),ctrl.add(fmt.title,name,{style:function(){return PreviewCss(ed,fmt)}}))}),ctrl.hasClasses=!0))}),DOM.bind(tags,"click",function(e){e.preventDefault();var node=ed.selection.getNode();node.getAttribute("data-mce-bogus")&&(node=node.parentNode),"BUTTON"===e.target.nodeName&&(DOM.remove(e.target),ed.dom.removeClass(node,e.target.value))}),DOM.add(path,tags),DOM.add(path,combobox),DOM.insertAfter(path,container),ctrl.renderTo(combobox)}),ed.onNodeChange.add(function(ed,cm,n,co){var value=n.getAttribute("class");tags.innerHTML="",value&&tinymce.each(value.split(" "),function(val,i){return!!/^(mce|wf-)/.test(val)||void DOM.add(tags,"button",{class:"mceButton","aria-label":"",value:val},"<label>"+val+"</label>")})})}}),tinymce.PluginManager.add("classpath",tinymce.plugins.ClassPathPlugin)}();