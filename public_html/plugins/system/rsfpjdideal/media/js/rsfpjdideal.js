let rsfpJdideal=function(a){this.formId=a,this.products=[this.formId],this.products[this.formId]=[],this.components=[],this.price=0,this.totalFieldname="",this.numberDecimals=null,this.decimal=null,this.thousands=null,this.taxtype=null,this.tax=null,this.priceFormat=/^[-]?\d+([.,]\d+)?$/,this.randomId=null,this.setRandomId=function(a){this.randomId=a},this.setTax=function(a,b){this.taxtype=a,this.tax=b},this.setDecimals=function(a,b,c){this.numberDecimals=a,this.decimal=b,this.thousands=c},this.setTotalField=function(a){this.totalFieldname=a},this.addProduct=function(a,b){let c=this.priceFormat.test(b);c&&("[object Array]"!==Object.prototype.toString.call(this.products[this.formId])&&(this.products[this.formId]=[]),this.products[this.formId][a]=b)},this.addComponent=function(a,b){"[object Array]"!==Object.prototype.toString.call(this.components[this.formId])&&(this.components[this.formId]=[]),-1===this.components[this.formId].indexOf(a)&&(this.components[this.formId][a]=b)},this.calculatePrice=function(){if("undefined"===this.products[this.formId])return console.log("No products"),console.log(this.products),void console.log(this.formId);this.price=0;let a=document.querySelectorAll("input[class=\""+this.randomId+"\"][name=\"rsfp_jdideal_item[]\"]");if(0<a.length)for(let b,c=0;c<a.length;c++)b=parseFloat(a[c].value),!0!==isNaN(b)&&(this.price+=b);for(let a in this.components[this.formId]){if("length"==a||!this.components[this.formId].hasOwnProperty(a))continue;let b=this.components[this.formId][a],c=document.getElementById("jdideal-"+a),d=document.getElementById("jdideal-quantity-"+a);if(null!==c)for(let a=0;a<c.options.length;a++)if(!0===c.options[a].selected){let e=this.products[this.formId][b+a+"|_|"+c.options[a].value],f=this.priceFormat.test(e);if(f){let a=1;null!==d&&(a=d.value),0<a.length&&(e*=this.cleanPrice(a)),this.price+=parseFloat(e)}}let e=document.querySelectorAll("input[type=\"checkbox\"][name^=\"form\\["+b+"\\]\"]"),f=document.querySelectorAll("[name^=\"form\\["+b+"\\]\\[quantity\\]\"]");for(let a=0;a<e.length;a++)if(!0===e[a].checked&&void 0!==this.products[this.formId][b+a+"|_|"+e[a].value]){let c=this.products[this.formId][b+a+"|_|"+e[a].value],d=this.priceFormat.test(c);if(d){let b=1;0<f.length&&(b=f[a].value),0<b.length&&(c*=this.cleanPrice(b)),this.price+=parseFloat(c)}}let g=document.getElementById("jdideal-inputbox-"+a);if(null!==g){let a=g.value;if(0<a.length){let c=this.cleanPrice(a);this.price+=c;let d=document.getElementById(b);d&&(d.value=c)}}let h=document.querySelectorAll("input[type=\"radio\"][name^=\"form\\["+b+"\\]\"]");f=document.querySelectorAll("[name^=\"form\\["+b+"\\]\\[quantity\\]\"]");for(let a=0;a<h.length;a++)if(!0===h[a].checked&&void 0!==this.products[this.formId][b+a+"|_|"+h[a].value]){let c=this.products[this.formId][b+a+"|_|"+h[a].value],d=this.priceFormat.test(c);if(d){let b=1;0<f.length&&(b=f[a].value),0<b.length&&(c*=this.cleanPrice(b)),this.price+=parseFloat(c)}}}this.addTax(),this.showTotal()},this.addTax=function(){0<this.price&&(this.price=this.taxtype?this.price+this.tax:this.price*(this.tax/100+1))},this.showTotal=function(){let a=document.getElementById("jdideal_total_"+this.formId);if(a&&(a.innerHTML=this.number_format(this.price,this.numberDecimals,this.decimal,this.thousands)),0<this.totalFieldname.length){let a=document.getElementById(this.totalFieldname);a&&(a.value=this.number_format(this.price,this.numberDecimals,".",""))}},this.cleanPrice=function(a){return-1!==a.indexOf(".")&&-1!==a.indexOf(",")&&(a=a.replace(".","")),parseFloat(a.replace(/,/g,"."))},this.number_format=function(a,b,c,d){let e=a,f=b;e=isFinite(+e)?+e:0,f=isFinite(+f)?Math.abs(f):0;let g,h,j="undefined"==typeof d?",":d,k="undefined"==typeof c?".":c,l=0<f?e.toFixed(f):Math.round(e).toFixed(f),m=Math.abs(e).toFixed(f);return 1e3<=m?(g=m.split(/\D/),h=g[0].length%3||3,g[0]=l.slice(0,h+(0>e))+g[0].slice(h).replace(/(\d{3})/g,j+"$1"),l=g.join(k)):l=l.replace(".",k),l}};