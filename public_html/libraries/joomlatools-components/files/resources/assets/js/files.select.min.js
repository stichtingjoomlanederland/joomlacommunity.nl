setTimeout((function(){window.addEvent("domready",(function(){if(0!==kQuery("#files-upload-multi").length){var e=Files.app;e.addEvent("uploadFile",(function(t){e.selected=t.path,kQuery("#insert-button").trigger("click")}));var t='<div style="text-align: center; display: none"><button class="btn btn-primary" type="button" id="insert-button" disabled>'+Koowa.translate("Insert")+"</button></div>";kQuery("#insert-button-container").append(kQuery.parseHTML(t));var i=function(t){var i=document.id(t.target).getParent(".files-node").retrieve("row");e.selected=i.path,document.id("insert-button").set("disabled",!1).getParent().setStyle("display","block")};e.grid.addEvent("clickFile",i),e.grid.addEvent("clickImage",i);var n=e.getUrl();if(n.getData("file")){var a=n.getData("file").replace(/\+/g," ");a=e.active?e.active+"/"+a:a;var r=e.grid.nodes.get(a);if(r&&r.element){var l="image"===r.filetype?"clickImage":"clickFile";e.grid.fireEvent(l,[{target:r.element.getElement("a")}])}}var c,d=n.getData("callback");if(d){if(-1!==d.indexOf(".")){c=window.parent;var o=d.split(".");kQuery.each(o,(function(e,t){if(c&&(c=c[t]),void 0===c||!c)return c=null,!1}))}else c=window.parent[d];"function"==typeof c&&kQuery("#insert-button").click((function(t){t.preventDefault(),c(e.selected)}))}}}))}),1e3);var fileSelected=function(e){kQuery("#storage_path_file").val(e).trigger("change"),void 0!==kQuery.magnificPopup&&kQuery.magnificPopup.instance&&kQuery.magnificPopup.close()};